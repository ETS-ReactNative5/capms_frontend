{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\suresoft\\\\Desktop\\\\vomproject\\\\sure-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\suresoft\\\\Desktop\\\\vomproject\\\\sure-frontend\\\\src\\\\pages\\\\managerSchedule\\\\ManagerSchedule.js\";\n\nimport moment from \"moment\";\nimport React, { useState, useEffect } from \"react\";\nimport { Table } from \"reactstrap\";\nimport Button from \"reactstrap/lib/Button\";\nimport Widget from \"../../components/Widget/Widget\";\nimport axios from 'axios';\nimport { Link } from \"react-router-dom\";\nimport './ManagerSchedule.scss';\nimport { useCookies } from 'react-cookie';\n\nvar Schedule = function Schedule() {\n  var authority = JSON.parse(localStorage.getItem(\"userInfo\")) ? JSON.parse(localStorage.getItem(\"userInfo\")).authority : \"\";\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      schedule = _useState2[0],\n      setSchedule = _useState2[1];\n\n  var _useState3 = useState(new Date()),\n      _useState4 = _slicedToArray(_useState3, 2),\n      today = _useState4[0],\n      setToday = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      days = _useState6[0],\n      setDays = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      members = _useState8[0],\n      setMembers = _useState8[1];\n\n  var _useCookies = useCookies(['token']),\n      _useCookies2 = _slicedToArray(_useCookies, 2),\n      cookies = _useCookies2[0],\n      removeCookie = _useCookies2[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      teams = _useState10[0],\n      setTeams = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      places = _useState12[0],\n      setPlaces = _useState12[1];\n\n  useEffect(function () {\n    var days = [];\n    var daynum = today.getDay();\n    var _today = today;\n\n    if (daynum === 0) {\n      _today = new Date(today).setDate(today.getDate() + 1);\n      daynum = 1;\n    }\n\n    if (daynum === 6) {\n      _today = new Date(today).setDate(today.getDate() + 2);\n      daynum = 1;\n    }\n\n    for (var i = 1; i < daynum; i++) {\n      days.push(moment(new Date(_today).setDate(new Date(_today).getDate() - daynum + i)).format(\"YYYY-MM-DD\"));\n    }\n\n    for (var _i = 0; _i < 6 - daynum; _i++) {\n      days.push(moment(new Date(_today).setDate(new Date(_today).getDate() + _i)).format(\"YYYY-MM-DD\"));\n    }\n\n    setDays(days);\n  }, [today]);\n\n  var onClickBefore = function onClickBefore() {\n    setToday(new Date(new Date(today).setDate(today.getDate() - 7)));\n  };\n\n  var onClickNext = function onClickNext() {\n    setToday(new Date(new Date(today).setDate(today.getDate() + 7)));\n  };\n\n  var onClickToday = function onClickToday() {\n    setToday(new Date());\n  };\n\n  useEffect(function () {\n    return findAllInfos();\n  }, []);\n\n  var findAllInfos = function findAllInfos() {\n    axios.defaults.headers.common['Authorization'] = cookies.token;\n    axios.all([axios.get(\"http://\".concat(process.env.REACT_APP_API_URL, \"/schedule\")), axios.get(\"http://\".concat(process.env.REACT_APP_API_URL, \"/members\")), axios.get(\"http://\".concat(process.env.REACT_APP_API_URL, \"/places\")), axios.get(\"http://\".concat(process.env.REACT_APP_API_URL, \"/teams\"))]).then(axios.spread(function (res1, res2, res3, res4) {\n      setSchedule(res1.data);\n      setMembers(res2.data);\n      setPlaces(res3.data);\n      setTeams(res4.data.sort(function (a, b) {\n        return a.num - b.num;\n      }));\n    })).catch(function (err) {\n      if (cookies.token) {\n        removeCookie('token');\n      }\n\n      alert(\"세션이 만료되었습니다. 다시 로그인 해주세요\");\n      window.location.href = \"/\";\n    });\n  };\n\n  var getColor = function getColor(date, _place) {\n    var place = places.find(function (place) {\n      return place.year == new Date(date).getFullYear() && place.name == _place;\n    });\n    return place ? place.color : '#fff';\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, authority == 0 || authority == 1 ? /*#__PURE__*/React.createElement(Widget, {\n    title: /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: 100 + '%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'space-between'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        fontSize: 30,\n        fontWeight: 700\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, \"\\uAD00\\uB9AC\\uC790 \\uC2A4\\uCF00\\uC904\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/app/schedule/add/week\",\n        state: {\n          date: days[0]\n        }\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      color: \"success\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }\n    }, \"\\uC77C\\uC8FC\\uC77C\\uCD94\\uAC00\")), /*#__PURE__*/React.createElement(Button, {\n      color: \"success\",\n      onClick: function onClick() {\n        return window.location.reload();\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 15\n      }\n    }, \"\\uC0C8\\uB85C\\uACE0\\uCE68\"))),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: 100 + '%',\n      textAlign: 'center',\n      fontWeight: 700,\n      fontSize: 20\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, days[0], \" ~ \", days[4], /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    onClick: onClickBefore,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 15\n    }\n  }, '<'), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: onClickToday,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 15\n    }\n  }, \"Today\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    onClick: onClickNext,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 15\n    }\n  }, '>'))), /*#__PURE__*/React.createElement(Table, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"manager-schedule__tr\",\n    style: {\n      textAlign: 'center'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 15\n    }\n  }, days.map(function (day, index) {\n    return /*#__PURE__*/React.createElement(\"th\", {\n      className: \"manager-schedule__th\",\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 19\n      }\n    }, moment(new Date(day)).format(\"ddd MM/DD\"));\n  }))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 15\n    }\n  }, days.map(function (day, index) {\n    return /*#__PURE__*/React.createElement(\"td\", {\n      key: index,\n      style: {\n        height: 'max-content',\n        width: 20 + '%'\n      },\n      className: day == moment(new Date()).format(\"YYYY-MM-DD\") ? 'manager-schedule__td today' : 'manager-schedule__td',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/app/schedule/add\",\n        state: {\n          date: day\n        }\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        minHeight: 27 + 'rem',\n        height: 100 + '%'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 23\n      }\n    }, schedule.filter(function (schedule) {\n      return schedule.날짜 === day;\n    }).sort(function (a, b) {\n      return members.find(function (member) {\n        return member.id === a.이름;\n      }).team && members.find(function (member) {\n        return member.id === b.이름;\n      }).team ? teams.find(function (_ref) {\n        var teamname = _ref.teamname;\n        return members.find(function (member) {\n          return member.id === a.이름;\n        }).team === teamname;\n      }).num - teams.find(function (_ref2) {\n        var teamname = _ref2.teamname;\n        return members.find(function (member) {\n          return member.id === b.이름;\n        }).team === teamname;\n      }).num : members.find(function (member) {\n        return member.id === a.이름;\n      }).team ? -1 : members.find(function (member) {\n        return member.id === b.이름;\n      }).team ? 1 : 0;\n    }).sort(function (a, b) {\n      return members.find(function (member) {\n        return member.id === a.이름;\n      }).직책 === \"실장\" ? -1 : 1;\n    }).map(function (d, i) {\n      if (d.날짜 === day) {\n        var member = members.find(function (_ref3) {\n          var id = _ref3.id;\n          return id === d.이름;\n        });\n        return /*#__PURE__*/React.createElement(Link, {\n          to: {\n            pathname: \"schedule/\".concat(d.id)\n          },\n          key: i,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 31\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"manager-schedule__div \" + d.이름,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 33\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 35\n          }\n        }, member ? member.name : \"\"), /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 35\n          }\n        }, \"\\uC624\\uC804 : \", /*#__PURE__*/React.createElement(\"span\", {\n          style: {\n            backgroundColor: getColor(d.날짜, d.오전)\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 45\n          }\n        }, d.오전)), /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 35\n          }\n        }, \"\\uC624\\uD6C4 : \", /*#__PURE__*/React.createElement(\"span\", {\n          style: {\n            backgroundColor: getColor(d.날짜, d.오후)\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 45\n          }\n        }, d.오후))));\n      }\n    }))));\n  }))))) : /*#__PURE__*/React.createElement(Widget, {\n    title: /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        fontSize: 30,\n        fontWeight: 700\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 11\n      }\n    }, \"\\uAD8C\\uD55C\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default Schedule;","map":{"version":3,"sources":["C:/Users/suresoft/Desktop/vomproject/sure-frontend/src/pages/managerSchedule/ManagerSchedule.js"],"names":["moment","React","useState","useEffect","Table","Button","Widget","axios","Link","useCookies","Schedule","authority","JSON","parse","localStorage","getItem","schedule","setSchedule","Date","today","setToday","days","setDays","members","setMembers","cookies","removeCookie","teams","setTeams","places","setPlaces","daynum","getDay","_today","setDate","getDate","i","push","format","onClickBefore","onClickNext","onClickToday","findAllInfos","defaults","headers","common","token","all","get","process","env","REACT_APP_API_URL","then","spread","res1","res2","res3","res4","data","sort","a","b","num","catch","err","alert","window","location","href","getColor","date","_place","place","find","year","getFullYear","name","color","width","display","flexDirection","justifyContent","fontSize","fontWeight","pathname","state","reload","textAlign","map","day","index","height","minHeight","filter","날짜","member","id","이름","team","teamname","직책","d","backgroundColor","오전","오후"],"mappings":"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","sourcesContent":["import moment from \"moment\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { Table } from \"reactstrap\";\r\nimport Button from \"reactstrap/lib/Button\";\r\nimport Widget from \"../../components/Widget/Widget\";\r\nimport axios from 'axios';\r\nimport { Link } from \"react-router-dom\";\r\nimport './ManagerSchedule.scss';\r\nimport { useCookies } from 'react-cookie';\r\n\r\nconst Schedule = () => {\r\n  const authority = JSON.parse(localStorage.getItem(\"userInfo\")) ? JSON.parse(localStorage.getItem(\"userInfo\")).authority : \"\";\r\n  const [schedule, setSchedule] = useState([]);\r\n  const [today, setToday] = useState(new Date());\r\n  const [days, setDays] = useState([]);\r\n  const [members, setMembers] = useState([]);\r\n  const [cookies, removeCookie] = useCookies(['token']);\r\n  const [teams, setTeams] = useState([]);\r\n  const [places, setPlaces] = useState([]);\r\n\r\n  useEffect(() => {\r\n    let days = [];\r\n    let daynum = today.getDay();\r\n    let _today = today;\r\n    if (daynum === 0) {\r\n      _today = new Date(today).setDate(today.getDate() + 1);\r\n      daynum = 1;\r\n    }\r\n    if (daynum === 6) {\r\n      _today = new Date(today).setDate(today.getDate() + 2);\r\n      daynum = 1;\r\n    }\r\n    for (let i = 1; i < daynum; i++) {\r\n      days.push(moment(new Date(_today).setDate(new Date(_today).getDate() - daynum + i)).format(\"YYYY-MM-DD\"));\r\n    }\r\n    for (let i = 0; i < 6 - daynum; i++) {\r\n      days.push(moment(new Date(_today).setDate(new Date(_today).getDate() + i)).format(\"YYYY-MM-DD\"));\r\n    }\r\n    setDays(days);\r\n  }, [today]);\r\n\r\n  const onClickBefore = () => {\r\n    setToday(new Date(new Date(today).setDate(today.getDate() - 7)));\r\n  };\r\n\r\n  const onClickNext = () => {\r\n    setToday(new Date(new Date(today).setDate(today.getDate() + 7)));\r\n  };\r\n\r\n  const onClickToday = () => {\r\n    setToday(new Date());\r\n  };\r\n\r\n  useEffect(()=> findAllInfos(), []);\r\n\r\n  const findAllInfos = () => {\r\n    axios.defaults.headers.common['Authorization'] = cookies.token;\r\n    axios\r\n    .all([\r\n      axios.get(`http://${process.env.REACT_APP_API_URL}/schedule`),\r\n      axios.get(`http://${process.env.REACT_APP_API_URL}/members`),\r\n      axios.get(`http://${process.env.REACT_APP_API_URL}/places`),\r\n      axios.get(`http://${process.env.REACT_APP_API_URL}/teams`)\r\n    ])\r\n    .then(axios.spread((res1,res2,res3,res4)=>{\r\n      setSchedule(res1.data);\r\n      setMembers(res2.data);\r\n      setPlaces(res3.data);\r\n      setTeams(res4.data.sort((a,b)=>a.num - b.num));\r\n    }))\r\n    .catch(err => {\r\n      if (cookies.token) {\r\n        removeCookie('token');\r\n      }\r\n      alert(\"세션이 만료되었습니다. 다시 로그인 해주세요\");\r\n      window.location.href = \"/\";\r\n    });\r\n  }\r\n\r\n  const getColor = (date, _place) => {\r\n    const place = places.find(place => place.year == new Date(date).getFullYear() && place.name == _place);\r\n    return place ? place.color : '#fff';\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {authority == 0 || authority == 1 ?\r\n        <Widget title={\r\n          <div style={{width: 100+'%', display: 'flex', flexDirection: 'row', justifyContent: 'space-between'}}>\r\n            <p style={{ fontSize:30, fontWeight: 700 }}>관리자 스케줄</p>\r\n            <div>\r\n              <Link to={{pathname: \"/app/schedule/add/week\", state: {date: days[0]}}}>\r\n                <Button color=\"success\">일주일추가</Button>\r\n              </Link>\r\n              <Button color=\"success\" onClick={() => window.location.reload()}>새로고침</Button>\r\n            </div>\r\n          </div>}>\r\n          <div style={{width: 100+'%', textAlign: 'center', fontWeight: 700, fontSize: 20}}>\r\n            {days[0]} ~ {days[4]}\r\n            <div>\r\n              <Button color=\"info\" onClick={onClickBefore}>{'<'}</Button>\r\n              <Button color=\"primary\" onClick={onClickToday}>Today</Button>\r\n              <Button color=\"info\" onClick={onClickNext}>{'>'}</Button>\r\n            </div>\r\n          </div>\r\n          <Table>\r\n            <thead>\r\n              <tr className=\"manager-schedule__tr\" style={{textAlign:'center'}}>\r\n                {days.map((day, index) => (\r\n                  <th className=\"manager-schedule__th\" key={index}>{moment(new Date(day)).format(\"ddd MM/DD\")}</th>\r\n                ))}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr>\r\n                {days.map((day, index) => (\r\n                  <td key={index} style={{height: 'max-content', width:20+ '%'}} className={day == moment(new Date()).format(\"YYYY-MM-DD\") ? 'manager-schedule__td today' : 'manager-schedule__td'}>\r\n                    <Link to={{pathname: `/app/schedule/add`, state: {date: day}}}>\r\n                      <div style={{minHeight: 27+'rem', height: 100 + '%'}}>\r\n                        {schedule\r\n                        .filter(schedule => schedule.날짜 === day)\r\n                        .sort((a,b)=> (members.find(member => member.id === a.이름).team && members.find(member => member.id === b.이름).team ?\r\n                        teams.find(({teamname}) => members.find(member => member.id === a.이름).team === teamname).num - teams.find(({teamname}) => members.find(member => member.id === b.이름).team === teamname).num\r\n                        : members.find(member => member.id === a.이름).team ? -1 : members.find(member => member.id === b.이름).team ? 1 : 0))\r\n                        .sort((a,b)=> members.find(member => member.id === a.이름).직책 === \"실장\" ? -1 : 1)\r\n                        .map((d, i) => {\r\n                          if (d.날짜 === day) {\r\n                            const member = members.find(({id}) => id === d.이름);\r\n                            return (\r\n                              <Link to={{pathname: `schedule/${d.id}`}} key={i}>\r\n                                <div className={\"manager-schedule__div \"+ d.이름}>\r\n                                  <div>{member ? member.name : \"\"}</div>\r\n                                  <div>오전 : <span style={{backgroundColor: getColor(d.날짜, d.오전)}}>{d.오전}</span></div>\r\n                                  <div>오후 : <span style={{backgroundColor: getColor(d.날짜, d.오후)}}>{d.오후}</span></div>\r\n                                </div>\r\n                              </Link>\r\n                            );\r\n                          }\r\n                        }\r\n                        )}\r\n                      </div>\r\n                    </Link>\r\n                  </td>\r\n                ))}\r\n              </tr>\r\n            </tbody>\r\n          </Table>\r\n        </Widget>\r\n        :\r\n        <Widget title={\r\n          <p style={{ fontSize:30, fontWeight: 700 }}>권한이 없습니다</p>\r\n        }>\r\n        </Widget>\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Schedule;"]},"metadata":{},"sourceType":"module"}