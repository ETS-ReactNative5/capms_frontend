{"ast":null,"code":"/*\n Highcharts JS v9.3.1 (2021-11-05)\n\n Exporting module\n\n (c) 2010-2021 Torstein Honsi\n\n License: www.highcharts.com/license\n*/\n'use strict';\n\n(function (a) {\n  \"object\" === typeof module && module.exports ? (a[\"default\"] = a, module.exports = a) : \"function\" === typeof define && define.amd ? define(\"highcharts/modules/export-data\", [\"highcharts\", \"highcharts/modules/exporting\"], function (k) {\n    a(k);\n    a.Highcharts = k;\n    return a;\n  }) : a(\"undefined\" !== typeof Highcharts ? Highcharts : void 0);\n})(function (a) {\n  function k(a, f, d, p) {\n    a.hasOwnProperty(f) || (a[f] = p.apply(null, d));\n  }\n\n  a = a ? a._modules : {};\n  k(a, \"Extensions/DownloadURL.js\", [a[\"Core/Globals.js\"]], function (a) {\n    var f = a.isSafari,\n        d = a.win,\n        p = d.document,\n        l = d.URL || d.webkitURL || d,\n        r = a.dataURLtoBlob = function (a) {\n      if ((a = a.replace(/filename=.*;/, \"\").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/)) && 3 < a.length && d.atob && d.ArrayBuffer && d.Uint8Array && d.Blob && l.createObjectURL) {\n        var f = d.atob(a[3]),\n            n = new d.ArrayBuffer(f.length);\n        n = new d.Uint8Array(n);\n\n        for (var c = 0; c < n.length; ++c) {\n          n[c] = f.charCodeAt(c);\n        }\n\n        a = new d.Blob([n], {\n          type: a[1]\n        });\n        return l.createObjectURL(a);\n      }\n    };\n\n    a = a.downloadURL = function (a, l) {\n      var n = d.navigator,\n          c = p.createElement(\"a\");\n\n      if (\"string\" === typeof a || a instanceof String || !n.msSaveOrOpenBlob) {\n        a = \"\" + a;\n        n = /Edge\\/\\d+/.test(n.userAgent);\n        if (f && \"string\" === typeof a && 0 === a.indexOf(\"data:application/pdf\") || n || 2E6 < a.length) if (a = r(a) || \"\", !a) throw Error(\"Failed to convert to blob\");\n        if (\"undefined\" !== typeof c.download) c.href = a, c.download = l, p.body.appendChild(c), c.click(), p.body.removeChild(c);else try {\n          var g = d.open(a, \"chart\");\n          if (\"undefined\" === typeof g || null === g) throw Error(\"Failed to open window\");\n        } catch (E) {\n          d.location.href = a;\n        }\n      } else n.msSaveOrOpenBlob(a, l);\n    };\n\n    return {\n      dataURLtoBlob: r,\n      downloadURL: a\n    };\n  });\n  k(a, \"Extensions/ExportData.js\", [a[\"Core/Axis/Axis.js\"], a[\"Core/Chart/Chart.js\"], a[\"Core/Renderer/HTML/AST.js\"], a[\"Core/Globals.js\"], a[\"Core/DefaultOptions.js\"], a[\"Core/Utilities.js\"], a[\"Extensions/DownloadURL.js\"]], function (a, f, d, p, l, r, n) {\n    function k(a, m) {\n      var b = g.navigator,\n          c = -1 < b.userAgent.indexOf(\"WebKit\") && 0 > b.userAgent.indexOf(\"Chrome\"),\n          d = g.URL || g.webkitURL || g;\n\n      try {\n        if (b.msSaveOrOpenBlob && g.MSBlobBuilder) {\n          var t = new g.MSBlobBuilder();\n          t.append(a);\n          return t.getBlob(\"image/svg+xml\");\n        }\n\n        if (!c) return d.createObjectURL(new g.Blob([\"\\uFEFF\" + a], {\n          type: m\n        }));\n      } catch (N) {}\n    }\n\n    var I = p.doc,\n        c = p.seriesTypes,\n        g = p.win;\n    p = l.getOptions;\n    l = l.setOptions;\n    var E = r.addEvent,\n        J = r.defined,\n        F = r.extend,\n        K = r.find,\n        C = r.fireEvent,\n        L = r.isNumber,\n        v = r.pick,\n        G = n.downloadURL;\n    l({\n      exporting: {\n        csv: {\n          annotations: {\n            itemDelimiter: \"; \",\n            join: !1\n          },\n          columnHeaderFormatter: null,\n          dateFormat: \"%Y-%m-%d %H:%M:%S\",\n          decimalPoint: null,\n          itemDelimiter: null,\n          lineDelimiter: \"\\n\"\n        },\n        showTable: !1,\n        useMultiLevelHeaders: !0,\n        useRowspanHeaders: !0\n      },\n      lang: {\n        downloadCSV: \"Download CSV\",\n        downloadXLS: \"Download XLS\",\n        exportData: {\n          annotationHeader: \"Annotations\",\n          categoryHeader: \"Category\",\n          categoryDatetimeHeader: \"DateTime\"\n        },\n        viewData: \"View data table\",\n        hideData: \"Hide data table\"\n      }\n    });\n    E(f, \"render\", function () {\n      this.options && this.options.exporting && this.options.exporting.showTable && !this.options.chart.forExport && !this.dataTableDiv && this.viewData();\n    });\n\n    f.prototype.setUpKeyToAxis = function () {\n      c.arearange && (c.arearange.prototype.keyToAxis = {\n        low: \"y\",\n        high: \"y\"\n      });\n      c.gantt && (c.gantt.prototype.keyToAxis = {\n        start: \"x\",\n        end: \"x\"\n      });\n    };\n\n    f.prototype.getDataRows = function (b) {\n      var m = this.hasParallelCoordinates,\n          y = this.time,\n          c = this.options.exporting && this.options.exporting.csv || {},\n          d = this.xAxis,\n          t = {},\n          f = [],\n          n = [],\n          p = [],\n          z;\n      var g = this.options.lang.exportData;\n\n      var l = g.categoryHeader,\n          M = g.categoryDatetimeHeader,\n          w = function w(q, e, m) {\n        if (c.columnHeaderFormatter) {\n          var d = c.columnHeaderFormatter(q, e, m);\n          if (!1 !== d) return d;\n        }\n\n        return q ? q instanceof a ? q.options.title && q.options.title.text || (q.dateTime ? M : l) : b ? {\n          columnTitle: 1 < m ? e : q.name,\n          topLevelColumnTitle: q.name\n        } : q.name + (1 < m ? \" (\" + e + \")\" : \"\") : l;\n      },\n          H = function H(a, b, e) {\n        var q = {},\n            m = {};\n        b.forEach(function (b) {\n          var c = (a.keyToAxis && a.keyToAxis[b] || b) + \"Axis\";\n          c = L(e) ? a.chart[c][e] : a[c];\n          q[b] = c && c.categories || [];\n          m[b] = c && c.dateTime;\n        });\n        return {\n          categoryMap: q,\n          dateTimeValueAxisMap: m\n        };\n      },\n          r = function r(a, b) {\n        return a.data.filter(function (a) {\n          return \"undefined\" !== typeof a.y && a.name;\n        }).length && b && !b.categories && !a.keyToAxis ? a.pointArrayMap && a.pointArrayMap.filter(function (a) {\n          return \"x\" === a;\n        }).length ? (a.pointArrayMap.unshift(\"x\"), a.pointArrayMap) : [\"x\", \"y\"] : a.pointArrayMap || [\"y\"];\n      },\n          h = [];\n\n      var x = 0;\n      this.setUpKeyToAxis();\n      this.series.forEach(function (a) {\n        var e = a.xAxis,\n            q = a.options.keys || r(a, e),\n            f = q.length,\n            g = !a.requireSorting && {},\n            k = d.indexOf(e),\n            B = H(a, q),\n            l;\n\n        if (!1 !== a.options.includeInDataExport && !a.options.isInternal && !1 !== a.visible) {\n          K(h, function (a) {\n            return a[0] === k;\n          }) || h.push([k, x]);\n\n          for (l = 0; l < f;) {\n            z = w(a, q[l], q.length), p.push(z.columnTitle || z), b && n.push(z.topLevelColumnTitle || z), l++;\n          }\n\n          var A = {\n            chart: a.chart,\n            autoIncrement: a.autoIncrement,\n            options: a.options,\n            pointArrayMap: a.pointArrayMap\n          };\n          a.options.data.forEach(function (b, d) {\n            m && (B = H(a, q, d));\n            var w = {\n              series: A\n            };\n            a.pointClass.prototype.applyOptions.apply(w, [b]);\n            b = w.x;\n            var h = a.data[d] && a.data[d].name;\n            l = 0;\n            if (!e || \"name\" === a.exportKey || !m && e && e.hasNames && h) b = h;\n            g && (g[b] && (b += \"|\" + d), g[b] = !0);\n            t[b] || (t[b] = [], t[b].xValues = []);\n            t[b].x = w.x;\n            t[b].name = h;\n\n            for (t[b].xValues[k] = w.x; l < f;) {\n              d = q[l], h = w[d], t[b][x + l] = v(B.categoryMap[d][h], B.dateTimeValueAxisMap[d] ? y.dateFormat(c.dateFormat, h) : null, h), l++;\n            }\n          });\n          x += l;\n        }\n      });\n\n      for (e in t) {\n        Object.hasOwnProperty.call(t, e) && f.push(t[e]);\n      }\n\n      var e = b ? [n, p] : [p];\n\n      for (x = h.length; x--;) {\n        var A = h[x][0];\n        var D = h[x][1];\n        var k = d[A];\n        f.sort(function (a, b) {\n          return a.xValues[A] - b.xValues[A];\n        });\n        g = w(k);\n        e[0].splice(D, 0, g);\n        b && e[1] && e[1].splice(D, 0, g);\n        f.forEach(function (a) {\n          var b = a.name;\n          k && !J(b) && (k.dateTime ? (a.x instanceof Date && (a.x = a.x.getTime()), b = y.dateFormat(c.dateFormat, a.x)) : b = k.categories ? v(k.names[a.x], k.categories[a.x], a.x) : a.x);\n          a.splice(D, 0, b);\n        });\n      }\n\n      e = e.concat(f);\n      C(this, \"exportData\", {\n        dataRows: e\n      });\n      return e;\n    };\n\n    f.prototype.getCSV = function (a) {\n      var b = \"\",\n          d = this.getDataRows(),\n          c = this.options.exporting.csv,\n          f = v(c.decimalPoint, \",\" !== c.itemDelimiter && a ? 1.1.toLocaleString()[1] : \".\"),\n          l = v(c.itemDelimiter, \",\" === f ? \";\" : \",\"),\n          g = c.lineDelimiter;\n      d.forEach(function (a, c) {\n        for (var m, y = a.length; y--;) {\n          m = a[y], \"string\" === typeof m && (m = '\"' + m + '\"'), \"number\" === typeof m && \".\" !== f && (m = m.toString().replace(\".\", f)), a[y] = m;\n        }\n\n        b += a.join(l);\n        c < d.length - 1 && (b += g);\n      });\n      return b;\n    };\n\n    f.prototype.getTable = function (a) {\n      var b = function b(a) {\n        if (!a.tagName || \"#text\" === a.tagName) return a.textContent || \"\";\n        var c = a.attributes,\n            d = \"<\" + a.tagName;\n        c && Object.keys(c).forEach(function (a) {\n          d += \" \" + a + '=\"' + c[a] + '\"';\n        });\n        d += \">\";\n        d += a.textContent || \"\";\n        (a.children || []).forEach(function (a) {\n          d += b(a);\n        });\n        return d += \"</\" + a.tagName + \">\";\n      };\n\n      a = this.getTableAST(a);\n      return b(a);\n    };\n\n    f.prototype.getTableAST = function (a) {\n      var b = 0,\n          c = [],\n          d = this.options,\n          f = a ? 1.1.toLocaleString()[1] : \".\",\n          l = v(d.exporting.useMultiLevelHeaders, !0);\n      a = this.getDataRows(l);\n\n      var g = l ? a.shift() : null,\n          k = a.shift(),\n          n = function n(a, b, c, d) {\n        var h = v(d, \"\");\n        b = \"text\" + (b ? \" \" + b : \"\");\n        \"number\" === typeof h ? (h = h.toString(), \",\" === f && (h = h.replace(\".\", f)), b = \"number\") : d || (b = \"empty\");\n        c = F({\n          \"class\": b\n        }, c);\n        return {\n          tagName: a,\n          attributes: c,\n          textContent: h\n        };\n      };\n\n      !1 !== d.exporting.tableCaption && c.push({\n        tagName: \"caption\",\n        attributes: {\n          \"class\": \"highcharts-table-caption\"\n        },\n        textContent: v(d.exporting.tableCaption, d.title.text ? d.title.text : \"Chart\")\n      });\n\n      for (var p = 0, r = a.length; p < r; ++p) {\n        a[p].length > b && (b = a[p].length);\n      }\n\n      c.push(function (a, b, c) {\n        var f = [],\n            h = 0;\n        c = c || b && b.length;\n        var m = 0,\n            e;\n\n        if (e = l && a && b) {\n          a: if (e = a.length, b.length === e) {\n            for (; e--;) {\n              if (a[e] !== b[e]) {\n                e = !1;\n                break a;\n              }\n            }\n\n            e = !0;\n          } else e = !1;\n\n          e = !e;\n        }\n\n        if (e) {\n          for (e = []; h < c; ++h) {\n            var g = a[h];\n            var k = a[h + 1];\n            g === k ? ++m : m ? (e.push(n(\"th\", \"highcharts-table-topheading\", {\n              scope: \"col\",\n              colspan: m + 1\n            }, g)), m = 0) : (g === b[h] ? d.exporting.useRowspanHeaders ? (k = 2, delete b[h]) : (k = 1, b[h] = \"\") : k = 1, g = n(\"th\", \"highcharts-table-topheading\", {\n              scope: \"col\"\n            }, g), 1 < k && g.attributes && (g.attributes.valign = \"top\", g.attributes.rowspan = k), e.push(g));\n          }\n\n          f.push({\n            tagName: \"tr\",\n            children: e\n          });\n        }\n\n        if (b) {\n          e = [];\n          h = 0;\n\n          for (c = b.length; h < c; ++h) {\n            \"undefined\" !== typeof b[h] && e.push(n(\"th\", null, {\n              scope: \"col\"\n            }, b[h]));\n          }\n\n          f.push({\n            tagName: \"tr\",\n            children: e\n          });\n        }\n\n        return {\n          tagName: \"thead\",\n          children: f\n        };\n      }(g, k, Math.max(b, k.length)));\n      var u = [];\n      a.forEach(function (a) {\n        for (var c = [], d = 0; d < b; d++) {\n          c.push(n(d ? \"td\" : \"th\", null, d ? {} : {\n            scope: \"row\"\n          }, a[d]));\n        }\n\n        u.push({\n          tagName: \"tr\",\n          children: c\n        });\n      });\n      c.push({\n        tagName: \"tbody\",\n        children: u\n      });\n      c = {\n        tree: {\n          tagName: \"table\",\n          id: \"highcharts-data-table-\" + this.index,\n          children: c\n        }\n      };\n      C(this, \"aftergetTableAST\", c);\n      return c.tree;\n    };\n\n    f.prototype.downloadCSV = function () {\n      var a = this.getCSV(!0);\n      G(k(a, \"text/csv\") || \"data:text/csv,\\uFEFF\" + encodeURIComponent(a), this.getFilename() + \".csv\");\n    };\n\n    f.prototype.downloadXLS = function () {\n      var a = '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head>\\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:\"0.00\";} .text{ mso-number-format:\"@\";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>' + this.getTable(!0) + \"</body></html>\";\n      G(k(a, \"application/vnd.ms-excel\") || \"data:application/vnd.ms-excel;base64,\" + g.btoa(unescape(encodeURIComponent(a))), this.getFilename() + \".xls\");\n    };\n\n    f.prototype.viewData = function () {\n      this.toggleDataTable(!0);\n    };\n\n    f.prototype.hideData = function () {\n      this.toggleDataTable(!1);\n    };\n\n    f.prototype.toggleDataTable = function (a) {\n      (a = v(a, !this.isDataTableVisible)) && !this.dataTableDiv && (this.dataTableDiv = I.createElement(\"div\"), this.dataTableDiv.className = \"highcharts-data-table\", this.renderTo.parentNode.insertBefore(this.dataTableDiv, this.renderTo.nextSibling));\n      this.dataTableDiv && (this.dataTableDiv.style.display = a ? \"block\" : \"none\", a && (this.dataTableDiv.innerHTML = \"\", new d([this.getTableAST()]).addToDOM(this.dataTableDiv), C(this, \"afterViewData\", this.dataTableDiv)));\n      this.isDataTableVisible = a;\n      a = this.exportDivElements;\n      var b = this.options.exporting,\n          c = b && b.buttons && b.buttons.contextButton.menuItems;\n      b = this.options.lang;\n      u && u.menuItemDefinitions && b && b.viewData && b.hideData && c && a && (a = a[c.indexOf(\"viewData\")]) && d.setElementHTML(a, this.isDataTableVisible ? b.hideData : b.viewData);\n    };\n\n    var u = p().exporting;\n    u && (F(u.menuItemDefinitions, {\n      downloadCSV: {\n        textKey: \"downloadCSV\",\n        onclick: function onclick() {\n          this.downloadCSV();\n        }\n      },\n      downloadXLS: {\n        textKey: \"downloadXLS\",\n        onclick: function onclick() {\n          this.downloadXLS();\n        }\n      },\n      viewData: {\n        textKey: \"viewData\",\n        onclick: function onclick() {\n          this.toggleDataTable();\n        }\n      }\n    }), u.buttons && u.buttons.contextButton.menuItems.push(\"separator\", \"downloadCSV\", \"downloadXLS\", \"viewData\"));\n    c.map && (c.map.prototype.exportKey = \"name\");\n    c.mapbubble && (c.mapbubble.prototype.exportKey = \"name\");\n    c.treemap && (c.treemap.prototype.exportKey = \"name\");\n  });\n  k(a, \"masters/modules/export-data.src.js\", [], function () {});\n});","map":null,"metadata":{},"sourceType":"script"}