{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\suresoft\\\\Desktop\\\\vomproject\\\\sure-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _toConsumableArray from \"C:\\\\Users\\\\suresoft\\\\Desktop\\\\vomproject\\\\sure-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"C:\\\\Users\\\\suresoft\\\\Desktop\\\\vomproject\\\\sure-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\suresoft\\\\Desktop\\\\vomproject\\\\sure-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\suresoft\\\\Desktop\\\\vomproject\\\\sure-frontend\\\\src\\\\pages\\\\projectList\\\\ProjectList.js\";\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Col, Row, Table } from 'reactstrap';\nimport Widget from '../../components/Widget/Widget';\nimport { Link } from 'react-router-dom';\nimport './ProjectList.scss';\nimport Button from 'reactstrap/lib/Button';\nimport moment from 'moment'; // 구글 시트 동기화\n\nvar _require = require(\"google-spreadsheet\"),\n    GoogleSpreadsheet = _require.GoogleSpreadsheet;\n\nvar gs_creds = require(\"./vom-shchoi-1f999190023a.json\"); // 키 생성 후 다운된 json파일을 지정합니다.\n\n\nvar doc = new GoogleSpreadsheet(\"12Y0F34Kt6MXPIjy_phTwgXO1_uD5ZqDU_UzucNBdSNI\");\n\nfunction authGoogleSheet() {\n  return _authGoogleSheet.apply(this, arguments);\n} // id, 팀수주, 팀매출, 프로젝트코드, 프로젝트명, 상태, 실, 고객사, 고객부서, ManMonth, 프로젝트계약금액_백만, 상반기예상수주, 상반기수주, 상반기예상매출, 상반기매출, 하반기예상수주, 하반기수주, 하반기예상매출, 하반기매출, 장비비, 컨설팅비, 도구비, 착수, 종료, 고객담당자, 근무지, 업무, 도구, 과제성격, 사업지역, PM, 투입명단, year, 주간보고서, 실적보고\n\n\nfunction _authGoogleSheet() {\n  _authGoogleSheet = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return doc.useServiceAccountAuth(gs_creds);\n\n          case 3:\n            _context.next = 5;\n            return doc.loadInfo();\n\n          case 5:\n            _context.next = 10;\n            break;\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(\"AUTH ERROR \", _context.t0);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 7]]);\n  }));\n  return _authGoogleSheet.apply(this, arguments);\n}\n\nfunction readFirstSheetRow(_x) {\n  return _readFirstSheetRow.apply(this, arguments);\n}\n\nfunction _readFirstSheetRow() {\n  _readFirstSheetRow = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data) {\n    var date, sheet, new_sheet;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            authGoogleSheet(); // 처음 시작할 때 문서 접속에 대한 인증을 처리하고 해당 문서를 로드합니다.\n\n            _context2.prev = 1;\n            date = moment(new Date()).format('YYYY-MM-DD');\n            _context2.next = 5;\n            return doc.loadInfo();\n\n          case 5:\n            sheet = doc.sheetsByTitle[date];\n\n            if (!sheet) {\n              _context2.next = 9;\n              break;\n            }\n\n            _context2.next = 9;\n            return sheet.delete();\n\n          case 9:\n            _context2.next = 11;\n            return doc.addSheet({\n              title: date\n            });\n\n          case 11:\n            new_sheet = _context2.sent;\n            _context2.next = 14;\n            return new_sheet.resize({\n              rowCount: 50,\n              columnCount: 35\n            });\n\n          case 14:\n            _context2.next = 16;\n            return new_sheet.setHeaderRow(['id', '팀수주', '팀매출', '프로젝트코드', '프로젝트명', '상태', '실', '고객사', '고객부서', 'ManMonth', '프로젝트계약금액_백만', '상반기예상수주', '상반기수주', '상반기예상매출', '상반기매출', '하반기예상수주', '하반기수주', '하반기예상매출', '하반기매출', '장비비', '컨설팅비', '도구비', '착수', '종료', '고객담당자', '근무지', '업무', '도구', '과제성격', '사업지역', 'PM', '투입명단', 'year', '주간보고서', '실적보고']);\n\n          case 16:\n            _context2.next = 18;\n            return new_sheet.addRows(data);\n\n          case 18:\n            _context2.next = 23;\n            break;\n\n          case 20:\n            _context2.prev = 20;\n            _context2.t0 = _context2[\"catch\"](1);\n            console.log(\"READ ERROR \", _context2.t0);\n\n          case 23:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[1, 20]]);\n  }));\n  return _readFirstSheetRow.apply(this, arguments);\n}\n\nvar ProjectList = function ProjectList() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      projects = _useState2[0],\n      setProjects = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      members = _useState4[0],\n      setMembers = _useState4[1];\n\n  var _useState5 = useState(moment(new Date()).format('YYYY')),\n      _useState6 = _slicedToArray(_useState5, 2),\n      year = _useState6[0],\n      setYear = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      term = _useState8[0],\n      setTerm = _useState8[1]; //상반기 == true, 하반기 == false\n\n\n  var compareAscSu = function compareAscSu(a, b) {\n    return a.팀수주 < b.팀수주 ? -1 : a.팀수주 > b.팀수주 ? 1 : 0;\n  };\n\n  var compareDescSu = function compareDescSu(a, b) {\n    return b.팀수주 < a.팀수주 ? -1 : b.팀수주 > a.팀수주 ? 1 : 0;\n  };\n\n  var compareAscMa = function compareAscMa(a, b) {\n    return a.팀매출 < b.팀매출 ? -1 : a.팀매출 > b.팀매출 ? 1 : 0;\n  };\n\n  var compareDescMa = function compareDescMa(a, b) {\n    return b.팀매출 < a.팀매출 ? -1 : b.팀매출 > a.팀매출 ? 1 : 0;\n  };\n\n  var sortList = function sortList(e) {\n    var arrayCopy = _toConsumableArray(projects);\n\n    switch (e.target.name) {\n      case \"ascSu\":\n        arrayCopy.sort(compareAscSu);\n        break;\n\n      case \"descSu\":\n        arrayCopy.sort(compareDescSu);\n        break;\n\n      case \"ascMa\":\n        arrayCopy.sort(compareAscMa);\n        break;\n\n      case \"descMa\":\n        arrayCopy.sort(compareDescMa);\n        break;\n\n      default:\n        return;\n    }\n\n    setProjects(arrayCopy);\n  };\n\n  useEffect(function () {\n    return findAllProjects();\n  }, []);\n\n  var findAllProjects = function findAllProjects() {\n    axios.all([axios.get(\"http://\".concat(process.env.REACT_APP_API_URL, \"/projects\")), axios.get(\"http://\".concat(process.env.REACT_APP_API_URL, \"/members\"))]).then(axios.spread(function (res1, res2) {\n      setProjects(res1.data);\n      setMembers(res2.data);\n    }));\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Widget, {\n    title: /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        fontSize: 30,\n        fontWeight: 700\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 26\n      }\n    }, \"\\uD504\\uB85C\\uC81D\\uD2B8\\uBAA9\\uB85D\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      marginBottom: 1 + 'rem'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'row'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    className: \"form-control\",\n    style: {\n      width: 10 + 'rem'\n    },\n    name: \"year\",\n    value: year,\n    onChange: function onChange(e) {\n      return setYear(e.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, _toConsumableArray(Array(moment(new Date()).format('YYYY') - 2019).keys()).map(function (i) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: i,\n      value: moment(new Date()).format('YYYY') - i,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 28\n      }\n    }, moment(new Date()).format('YYYY') - i);\n  })), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    style: {\n      marginLeft: 1 + 'rem'\n    },\n    onClick: function onClick() {\n      setTerm(!term);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, term ? '상반기' : '하반기')), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"warning\",\n    onClick: function onClick() {\n      return readFirstSheetRow(projects);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, \"\\uC2A4\\uD504\\uB808\\uB4DC\\uC2DC\\uD2B8 \\uB3D9\\uAE30\\uD654\"), /*#__PURE__*/React.createElement(Link, {\n    to: \"/app/projects/new\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 46\n    }\n  }, \"\\uC0C8\\uB85C\\uC6B4 \\uD504\\uB85C\\uC81D\\uD2B8\")))), /*#__PURE__*/React.createElement(Table, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 19\n    }\n  }, \"\\uD300(\\uC218\\uC8FC)\", /*#__PURE__*/React.createElement(\"button\", {\n    className: \"orderBtn glyphicon glyphicon-collapse\",\n    name: \"ascSu\",\n    onClick: sortList,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 66\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"orderBtn glyphicon glyphicon-collapse-top\",\n    name: \"descSu\",\n    onClick: sortList,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 157\n    }\n  })), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 19\n    }\n  }, \"\\uD300(\\uB9E4\\uCD9C)\", /*#__PURE__*/React.createElement(\"button\", {\n    className: \"orderBtn glyphicon glyphicon-collapse\",\n    name: \"ascMa\",\n    onClick: sortList,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 66\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"orderBtn glyphicon glyphicon-collapse-top\",\n    name: \"descMa\",\n    onClick: sortList,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 157\n    }\n  })), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-3 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 19\n    }\n  }, \"\\uD504\\uB85C\\uC81D\\uD2B8 \\uBA85\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 19\n    }\n  }, \"\\uD558\\uBC18\\uAE30 \\uC608\\uC0C1\\uC218\\uC8FC\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 19\n    }\n  }, \"\\uD558\\uBC18\\uAE30 \\uC218\\uC8FC\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 19\n    }\n  }, \"\\uD558\\uBC18\\uAE30 \\uC608\\uC0C1\\uB9E4\\uCD9C\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 19\n    }\n  }, \"\\uD558\\uBC18\\uAE30 \\uB9E4\\uCD9C\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 19\n    }\n  }, \"\\uCEE8\\uC124\\uD305\\uBE44\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"col-md-1 project-list__th\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 19\n    }\n  }, \"PM\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, projects.filter(function (project) {\n    return project.year == year;\n  }).map(function (project, index) {\n    var member = members.find(function (_ref) {\n      var id = _ref.id;\n      return id === project.PM;\n    });\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }\n    }, project.팀수주), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 21\n      }\n    }, project.팀매출), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-3 project-list__td\",\n      style: {\n        whiteSpace: 'break-spaces'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/app/projects/detail/\".concat(project.id, \"/\").concat(year)\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 23\n      }\n    }, project.프로젝트명)), term ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 23\n      }\n    }, project.상반기예상수주), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 23\n      }\n    }, project.상반기수주), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 23\n      }\n    }, project.상반기예상매출), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 23\n      }\n    }, project.상반기매출)) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 23\n      }\n    }, project.하반기예상수주), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 23\n      }\n    }, project.하반기수주), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 23\n      }\n    }, project.하반기예상매출), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 23\n      }\n    }, project.하반기매출)), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 21\n      }\n    }, project.컨설팅비), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"col-md-1 project-list__td\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 21\n      }\n    }, member ? member.name : \"\"));\n  })))))));\n};\n\nexport default ProjectList;","map":{"version":3,"sources":["C:/Users/suresoft/Desktop/vomproject/sure-frontend/src/pages/projectList/ProjectList.js"],"names":["React","useState","useEffect","axios","Col","Row","Table","Widget","Link","Button","moment","require","GoogleSpreadsheet","gs_creds","doc","authGoogleSheet","useServiceAccountAuth","loadInfo","console","log","readFirstSheetRow","data","date","Date","format","sheet","sheetsByTitle","delete","addSheet","title","new_sheet","resize","rowCount","columnCount","setHeaderRow","addRows","ProjectList","projects","setProjects","members","setMembers","year","setYear","term","setTerm","compareAscSu","a","b","팀수주","compareDescSu","compareAscMa","팀매출","compareDescMa","sortList","e","arrayCopy","target","name","sort","findAllProjects","all","get","process","env","REACT_APP_API_URL","then","spread","res1","res2","fontSize","fontWeight","display","flexDirection","justifyContent","marginBottom","width","value","Array","keys","map","i","marginLeft","filter","project","index","member","find","id","PM","whiteSpace","pathname","프로젝트명","상반기예상수주","상반기수주","상반기예상매출","상반기매출","하반기예상수주","하반기수주","하반기예상매출","하반기매출","컨설팅비"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Col, Row, Table } from 'reactstrap';\r\nimport Widget from '../../components/Widget/Widget';\r\nimport { Link } from 'react-router-dom';\r\nimport './ProjectList.scss';\r\nimport Button from 'reactstrap/lib/Button';\r\nimport moment from 'moment';\r\n\r\n// 구글 시트 동기화\r\nconst {GoogleSpreadsheet} = require(\"google-spreadsheet\");\r\nconst gs_creds = require(\"./vom-shchoi-1f999190023a.json\"); // 키 생성 후 다운된 json파일을 지정합니다.\r\nconst doc = new GoogleSpreadsheet(\"12Y0F34Kt6MXPIjy_phTwgXO1_uD5ZqDU_UzucNBdSNI\");\r\n\r\nasync function authGoogleSheet(){\r\n\ttry{\r\n\t\tawait doc.useServiceAccountAuth(gs_creds);\r\n\t\tawait doc.loadInfo()\r\n\t}catch(err){\r\n\t\tconsole.log( \"AUTH ERROR \", err)\r\n\t}\r\n}\r\n\r\n// id, 팀수주, 팀매출, 프로젝트코드, 프로젝트명, 상태, 실, 고객사, 고객부서, ManMonth, 프로젝트계약금액_백만, 상반기예상수주, 상반기수주, 상반기예상매출, 상반기매출, 하반기예상수주, 하반기수주, 하반기예상매출, 하반기매출, 장비비, 컨설팅비, 도구비, 착수, 종료, 고객담당자, 근무지, 업무, 도구, 과제성격, 사업지역, PM, 투입명단, year, 주간보고서, 실적보고\r\nasync function readFirstSheetRow(data){\r\n  authGoogleSheet(); // 처음 시작할 때 문서 접속에 대한 인증을 처리하고 해당 문서를 로드합니다.\r\n  try{\r\n    const date = moment(new Date()).format('YYYY-MM-DD');\r\n    await doc.loadInfo();\r\n    const sheet = doc.sheetsByTitle[date];\r\n    if (sheet){\r\n      await sheet.delete();\r\n    }\r\n    const new_sheet = await doc.addSheet({title: date});\r\n    await new_sheet.resize({ rowCount: 50, columnCount: 35 });\r\n    await new_sheet.setHeaderRow(['id', '팀수주', '팀매출', '프로젝트코드', '프로젝트명', '상태', '실', '고객사', '고객부서', 'ManMonth', '프로젝트계약금액_백만', '상반기예상수주', '상반기수주', '상반기예상매출', '상반기매출', '하반기예상수주', '하반기수주', '하반기예상매출', '하반기매출', '장비비', '컨설팅비', '도구비', '착수', '종료', '고객담당자', '근무지', '업무', '도구', '과제성격', '사업지역', 'PM', '투입명단', 'year', '주간보고서', '실적보고']);\r\n    await new_sheet.addRows(data);\r\n  }catch(err){\r\n    console.log( \"READ ERROR \", err)\r\n  }\r\n}\r\n\r\nconst ProjectList = () => {\r\n  const [projects , setProjects] = useState([]);\r\n  const [members , setMembers] = useState([]);\r\n  const [year, setYear] = useState(moment(new Date()).format('YYYY'));\r\n  const [term, setTerm] = useState(true); //상반기 == true, 하반기 == false\r\n  \r\n  const compareAscSu = (a, b) => a.팀수주 < b.팀수주 ? -1 : a.팀수주 > b.팀수주 ? 1 : 0;\r\n  const compareDescSu = (a, b) => b.팀수주 < a.팀수주 ? -1 : b.팀수주 > a.팀수주 ? 1 : 0;\r\n  const compareAscMa = (a, b) => a.팀매출 < b.팀매출 ? -1 : a.팀매출 > b.팀매출 ? 1 : 0;\r\n  const compareDescMa = (a, b) => b.팀매출 < a.팀매출 ? -1 : b.팀매출 > a.팀매출 ? 1 : 0;\r\n\r\n  const sortList = (e) => {\r\n    let arrayCopy = [...projects];\r\n    switch (e.target.name) {\r\n      case \"ascSu\":\r\n        arrayCopy.sort(compareAscSu);\r\n        break;\r\n      case \"descSu\":\r\n        arrayCopy.sort(compareDescSu);\r\n        break;\r\n      case \"ascMa\":\r\n        arrayCopy.sort(compareAscMa);\r\n        break;\r\n      case \"descMa\":\r\n        arrayCopy.sort(compareDescMa);\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n    setProjects(arrayCopy);\r\n  };\r\n\r\n  useEffect(()=> findAllProjects(), []);\r\n\r\n  const findAllProjects = () => {\r\n    axios\r\n    .all([\r\n    axios.get(`http://${process.env.REACT_APP_API_URL}/projects`),\r\n    axios.get(`http://${process.env.REACT_APP_API_URL}/members`)])\r\n    .then(axios.spread((res1,res2)=>{\r\n      setProjects(res1.data);\r\n      setMembers(res2.data);\r\n    }))\r\n }\r\n\r\n  return (\r\n    <>\r\n      <Row>\r\n        <Col>\r\n          <Widget title={<p style={{ fontSize:30, fontWeight: 700 }}>프로젝트목록</p>}>\r\n            <div style={{display: 'flex', flexDirection:'row', justifyContent: 'space-between', marginBottom: 1+'rem'}}>\r\n              <div style={{display: 'flex', flexDirection:'row'}}>\r\n                <select className=\"form-control\" style={{width: 10+'rem'}} name=\"year\" value={year} onChange={(e)=>setYear(e.target.value)}>\r\n                  {[...Array(moment(new Date()).format('YYYY') - 2019).keys()]\r\n                  .map((i)=>{\r\n                    return <option key={i} value={moment(new Date()).format('YYYY') - i}>{moment(new Date()).format('YYYY') - i}</option>\r\n                  })}\r\n                </select>\r\n                <Button color=\"primary\" style={{marginLeft: 1+'rem'}} onClick={()=>{\r\n                  setTerm(!term);\r\n                }}>{term ? '상반기' : '하반기'}</Button>\r\n              </div>\r\n              <div>\r\n                <Button color=\"warning\" onClick={() => readFirstSheetRow(projects)}>스프레드시트 동기화</Button>\r\n                <Link to=\"/app/projects/new\"><button className=\"btn btn-primary\">새로운 프로젝트</button></Link>\r\n              </div>\r\n            </div>\r\n            <Table>\r\n              <thead>\r\n                <tr>\r\n                  <th className=\"col-md-1 project-list__th\">팀(수주)<button className=\"orderBtn glyphicon glyphicon-collapse\" name=\"ascSu\" onClick={sortList}/><button className=\"orderBtn glyphicon glyphicon-collapse-top\" name=\"descSu\" onClick={sortList}/></th>\r\n                  <th className=\"col-md-1 project-list__th\">팀(매출)<button className=\"orderBtn glyphicon glyphicon-collapse\" name=\"ascMa\" onClick={sortList}/><button className=\"orderBtn glyphicon glyphicon-collapse-top\" name=\"descMa\" onClick={sortList}/></th>\r\n                  <th className=\"col-md-3 project-list__th\">프로젝트 명</th>\r\n                  <th className=\"col-md-1 project-list__th\">하반기 예상수주</th>\r\n                  <th className=\"col-md-1 project-list__th\">하반기 수주</th>\r\n                  <th className=\"col-md-1 project-list__th\">하반기 예상매출</th>\r\n                  <th className=\"col-md-1 project-list__th\">하반기 매출</th>\r\n                  <th className=\"col-md-1 project-list__th\">컨설팅비</th>\r\n                  <th className=\"col-md-1 project-list__th\">PM</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {projects\r\n                .filter((project)=> project.year == year)\r\n                .map((project, index) => {\r\n                  const member = members.find(({id}) => id === project.PM);\r\n                  return(\r\n                  <tr key={index}>\r\n                    <td className=\"col-md-1 project-list__td\">{project.팀수주}</td>\r\n                    <td className=\"col-md-1 project-list__td\">{project.팀매출}</td>\r\n                    <td className=\"col-md-3 project-list__td\" style={{whiteSpace: 'break-spaces'}}>\r\n                      <Link to={{pathname: `/app/projects/detail/${project.id}/${year}`}}>\r\n                        {project.프로젝트명}\r\n                      </Link>\r\n                    </td>\r\n                    {term ?\r\n                    <>\r\n                      <td className=\"col-md-1 project-list__td\">{project.상반기예상수주}</td>\r\n                      <td className=\"col-md-1 project-list__td\">{project.상반기수주}</td>\r\n                      <td className=\"col-md-1 project-list__td\">{project.상반기예상매출}</td>\r\n                      <td className=\"col-md-1 project-list__td\">{project.상반기매출}</td>\r\n                    </>\r\n                    :\r\n                    <>\r\n                      <td className=\"col-md-1 project-list__td\">{project.하반기예상수주}</td>\r\n                      <td className=\"col-md-1 project-list__td\">{project.하반기수주}</td>\r\n                      <td className=\"col-md-1 project-list__td\">{project.하반기예상매출}</td>\r\n                      <td className=\"col-md-1 project-list__td\">{project.하반기매출}</td>\r\n                    </>\r\n                    }\r\n                    <td className=\"col-md-1 project-list__td\">{project.컨설팅비}</td>\r\n                    <td className=\"col-md-1 project-list__td\">{member ? member.name : \"\"}</td>\r\n                  </tr>\r\n                )})}\r\n              </tbody>\r\n            </Table>\r\n          </Widget>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ProjectList;"]},"metadata":{},"sourceType":"module"}